<div class="card shadow-sm rounded-3 p-3 mb-4">
  <!-- Header -->
  <div class="d-flex justify-content-between align-items-center">
    <h5 class="fw-bold mb-0 custom-bold">
      {{ this.bookingStateService.selectedDate() | date : "EEE d MMM y" }} at
      {{ this.bookingStateService.selectedHour() }}
    </h5>
    <div class="d-flex align-items-center gap-2">
      <div
        class="d-flex align-items-center justify-content-center rounded-circle"
        style="width: 32px; height: 32px; background-color: #ffe6f0"
      >
        <span class="material-icons" style="color: #ff4da6; font-size: 18px">
          favorite
        </span>
      </div>
      <span class="fw-semibold text-muted custom-muted">{{
        this.bookingStateService.staffSeleted().name
      }}</span>
    </div>
  </div>

  <!-- Salon Info -->
  <div class="d-flex align-items-center justify-content-between mt-3">
    <div class="d-flex align-items-center">
      <img
        src="logo.jpg"
        alt="Salon"
        class="rounded me-3"
        width="60"
        height="60"
      />
      <div>
        <h6 class="mb-0 fw-bold custom-bold">Regal Nails & Spa</h6>
        <small class="text-muted custom-muted"
          >1942 Parkedale Ave, Brockville</small
        ><br />
        <small class="text-muted custom-muted">Phone: +1 343-585-6886</small>
      </div>
    </div>

    <!-- Action buttons -->
    <div class="d-flex gap-3 text-center">
      <a
        class="btn btn-light d-flex flex-column align-items-center"
        href="https://maps.app.goo.gl/fG439HpqM3YLDGnm7"
        target="_blank"
      >
        <span class="material-icons">pin_drop</span>
        <small>Directions</small>
      </a>
      <button
        class="btn btn-light d-flex flex-column align-items-center"
        (click)="onPrevStep()"
      >
        <span class="material-icons">event</span>
        <small>Reschedule</small>
      </button>
      <button
        class="btn btn-light d-flex flex-column align-items-center"
        (click)="reloadPage()"
      >
        <span class="material-icons">close</span>
        <small>Cancel</small>
      </button>
    </div>
  </div>

  <!-- Service Details -->
  <div class="border rounded mt-3">
    @for (mainService of bookingStateService.mainServiceSelected(); track
    mainService.id) {
    <div
      class="d-flex justify-content-between align-items-start p-3 border-bottom"
    >
      <div>
        <div class="fw-bold custom-bold">{{ mainService.name }}</div>
        <small class="text-muted custom-muted">{{
          mainService.durationTime | duration : "string"
        }}</small>
      </div>
      <div class="text-end">
        <div class="fw-bold custom-bold">CAD {{ mainService.price }}</div>
        <small class="text-muted custom-muted">{{
          mainService.priceType
        }}</small>
      </div>
    </div>
    @for (subService of mainService.subServices; track
    subService.id) {
    <div
      class="d-flex justify-content-between align-items-start py-2 pe-3 border-bottom ps-5"
    >
      <div>
        <div class="fw-bold custom-bold-subservice">{{ subService.name }}</div>
        <small class="text-muted custom-muted-subservice">{{
          subService.durationTime | duration : "string"
        }}</small>
      </div>
      <div class="text-end">
        <div class="fw-bold custom-bold-subservice">CAD {{ subService.price }}</div>
        <small class="text-muted custom-muted-subservice">{{
          subService.priceType
        }}</small>
      </div>
    </div>
    } }

    <div class="d-flex justify-content-between p-3 fw-bold custom-bold">
      <span>Estimated Total ({{this.bookingStateService.getTotalDuration() | duration:"number"}})</span>
      <span>CAD {{ this.bookingStateService.getTotalPrice() }} + Taxes</span>
    </div>
  </div>

  <!-- Customer Info -->
  <form class="mt-4" [formGroup]="customerInfoForm" (ngSubmit)="onSubmit()">
    <h6 class="fw-bold mb-3 custom-bold">Your Details</h6>
    <div class="form-floating mb-3">
      <input
        type="text"
        class="form-control"
        id="customerName"
        placeholder="Your Name"
        formControlName="name"
      />
      <label for="customerName">Name</label>
    </div>
    <div class="form-floating mb-3">
      <input
        type="email"
        class="form-control"
        id="customerEmail"
        placeholder="name@example.com"
        formControlName="email"
      />
      <label for="customerEmail">Email</label>
    </div>
    <div class="form-floating">
      <textarea
        class="form-control"
        placeholder="Leave a note for the salon"
        id="customerNotes"
        style="height: 70px"
        formControlName="notes"
      ></textarea>
      <label for="customerNotes">Add booking notes</label>
    </div>
    @if (customerInfoForm.touched && customerInfoForm.invalid) {
    <div class="notice">Please enter your name and email.</div>
    }

    <button
      class="btn-book-now mt-4"
      type="submit"
      [disabled]="
        (customerInfoForm.touched && customerInfoForm.invalid) ||
        customerInfoForm.untouched
      "
      [class.disabled]="
        (customerInfoForm.touched && customerInfoForm.invalid) ||
        customerInfoForm.untouched
      "
    >
      Book now
    </button>
  </form>
</div>
